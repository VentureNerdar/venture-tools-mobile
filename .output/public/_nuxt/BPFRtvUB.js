import{s as w,a as y}from"./C6abUHzI.js";import{s as g}from"./k7C1jPJg.js";import{s as K}from"./mNSUlnpU.js";import{s as V}from"./B1KU7L_H.js";import{g as _,H as v,j as F,r as I,p as N,l as c,c as x,b as e,w as a,o as B,s as n,d as C}from"./DnhPwC4b.js";import"./zergljvx.js";import"./DBqnYECb.js";import{s as E}from"./BbbgPN3f.js";import{u as S}from"./BQheVLCO.js";import"./DfeQPru4.js";import"./B3z-eVN2.js";import"./DjME5Ryy.js";import"./B2K9ucRi.js";import"./XiNJrTcZ.js";import"./C271KI0g.js";import"./DP6o21KL.js";import"./DbOjpsTG.js";import"./BjOoacbl.js";import"./BUrrvWPo.js";const Z=_({__name:"edit-pin",setup($){const p=v(),l=S();F(async()=>{await l.loadFromSecureStorage()});const o=I({form:{pin:"",confirmPin:"",currentPin:""},errorInfo:"",currentPinError:"",show:{pinKeyboard:!1,confirmPinKeyboard:!1,currentPinKeyboard:!1}}),i={handle:{focus:{pin:()=>{o.show.pinKeyboard=!0,o.show.confirmPinKeyboard=!1,o.show.currentPinKeyboard=!1},confirmPin:()=>{o.show.confirmPinKeyboard=!0,o.show.pinKeyboard=!1,o.show.currentPinKeyboard=!1},currentPin:()=>{o.show.currentPinKeyboard=!0,o.show.pinKeyboard=!1,o.show.confirmPinKeyboard=!1}},blur:{currentPin:()=>{o.show.currentPinKeyboard=!1,o.form.currentPin.length===4&&o.form.currentPin!==l.pinCode?o.currentPinError="Incorrect PIN":o.currentPinError=""}}}},d=N(()=>{const u=o.form.pin.length===4&&o.form.confirmPin.length===4,r=o.form.pin===o.form.confirmPin,s=o.form.currentPin===l.pinCode;return u&&r&&s});c([()=>o.form.pin,()=>o.form.confirmPin],()=>{const u=o.form.pin.length===4&&o.form.confirmPin.length===4,r=o.form.pin===o.form.confirmPin;o.errorInfo=u&&!r?"PINs do not match":""}),c([()=>o.form.confirmPin,()=>o.form.currentPin],()=>{o.form.confirmPin.length===4&&o.form.confirmPin!==o.form.pin?o.currentPinError="PINs do not match":o.currentPinError=""});const P=()=>{d.value&&(l.setPinNumber(o.form.pin),E({type:"success",message:"PIN changed successfully",duration:2e3}),setTimeout(()=>{p.push("/settings/security")},300))};return(u,r)=>{const s=w,m=y,f=g,h=K,b=V;return B(),x("div",null,[e(f,{title:"Enter current PIN",style:{"padding-top":"10px","padding-bottom":"10px"}},{default:a(()=>[e(s,{value:n(o).form.currentPin,focused:n(o).show.currentPinKeyboard,"error-info":n(o).currentPinError,length:"4",onFocus:i.handle.focus.currentPin,onBlur:i.handle.blur.currentPin},null,8,["value","focused","error-info","onFocus","onBlur"]),e(m,{modelValue:n(o).form.currentPin,"onUpdate:modelValue":r[0]||(r[0]=t=>n(o).form.currentPin=t),show:n(o).show.currentPinKeyboard,onBlur:i.handle.blur.currentPin},null,8,["modelValue","show","onBlur"])]),_:1}),e(f,{title:"Enter new PIN",style:{"padding-top":"10px","padding-bottom":"10px"}},{default:a(()=>[e(s,{value:n(o).form.pin,focused:n(o).show.pinKeyboard,length:"4",onFocus:i.handle.focus.pin},null,8,["value","focused","onFocus"]),e(m,{modelValue:n(o).form.pin,"onUpdate:modelValue":r[1]||(r[1]=t=>n(o).form.pin=t),show:n(o).show.pinKeyboard,onBlur:r[2]||(r[2]=t=>n(o).show.pinKeyboard=!1)},null,8,["modelValue","show"])]),_:1}),e(f,{title:"Confirm new PIN",style:{"padding-top":"10px","padding-bottom":"10px"}},{default:a(()=>[e(s,{value:n(o).form.confirmPin,focused:n(o).show.confirmPinKeyboard,"error-info":n(o).errorInfo,length:"4",onFocus:i.handle.focus.confirmPin},null,8,["value","focused","error-info","onFocus"]),e(m,{modelValue:n(o).form.confirmPin,"onUpdate:modelValue":r[3]||(r[3]=t=>n(o).form.confirmPin=t),show:n(o).show.confirmPinKeyboard,onBlur:r[4]||(r[4]=t=>n(o).show.confirmPinKeyboard=!1)},null,8,["modelValue","show"])]),_:1}),e(b,null,{default:a(()=>[e(h,{block:"",type:"success",disabled:!n(d),onClick:P},{default:a(()=>r[5]||(r[5]=[C(" Save ")])),_:1},8,["disabled"])]),_:1})])}}});export{Z as default};
