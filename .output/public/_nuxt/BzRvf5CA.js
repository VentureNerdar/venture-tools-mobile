import{s as L}from"./lvnqdlSG.js";import{x as M,m as h,g as v,r as k,c as G,b as N,w as E,v as R,o as x,d as U,t as A,s as F}from"./CJVGzo24.js";import{R as i,u as I}from"./DjSXyAZa.js";import{u as p}from"./BmVm5dzA.js";import{u as S}from"./BIzZP0jH.js";import{u as C,a as w}from"./LOvsw2I0.js";import{u as _}from"./D7NHJUtr.js";import{S as m}from"./CksZ33d2.js";import{u as V}from"./BVPXK9nR.js";import{_ as W}from"./DlAUqK2U.js";import"./DrGbu7j2.js";import"./6XK8G8Gr.js";import"./C1IScSLr.js";import"./Bf4hYtEl.js";import"./BoHWtOdR.js";import"./DfeQPru4.js";import"./j8lHVsrf.js";import"./BttZGFy9.js";import"./BhuWYpfo.js";import"./DECEjZPt.js";const J=M("communities",()=>{const c=h({}),a=h({});return{communities:c,communityChecklists:a,loadFromSecureStorage:async()=>{try{const o=await m.get({key:"communities"});c.value=JSON.parse(o.value)}catch(o){console.log(o),c.value={}}try{const o=await m.get({key:"communityChecklists"});a.value=JSON.parse(o.value)}catch(o){console.log(o),a.value={}}},setCommunities:async o=>{c.value=o,await m.set({key:"communities",value:JSON.stringify(o)})},setCommunityChecklists:async o=>{a.value=o,await m.set({key:"communityChecklists",value:JSON.stringify(o)})}}}),q={class:"wrap"},D=v({__name:"splash",setup(c){const a=async(e,n)=>{try{const{value:l}=await m.get({key:e});return JSON.parse(l)}catch{return n}},f=e=>new Promise(n=>setTimeout(n,e)),s=k({completedModules:[],currentTaskText:"",defaultStoreOptions:{isPersist:!0},stores:{languages:p(),settings:S()},logoLoaded:!1}),r={all:!0},o=[["User Roles",i.USERS_ROLES,"userRoles",{...s.defaultStoreOptions,key:"userRoles",storeState:V().userRoles},{...r,whereNotIn:{key:"id",value:[1,2]}}],["Languages",i.LANGUAGES,"languages",{...s.defaultStoreOptions,key:"languages",storeState:p().languages},{...r,with:JSON.stringify(["translations"])}],["Language Words",i.LANGUAGE_WORDS,"languageWords",{...s.defaultStoreOptions,key:"languageWords",storeState:p().words},r],["Statuses",i.SETTINGS_STATUSES,"statuses",{...s.defaultStoreOptions,key:"statuses",storeState:S().statuses},r],["People Groups",i.PEOPLE_GROUPS,"peopleGroups",{...s.defaultStoreOptions,key:"peopleGroups",storeState:C().peopleGroups},r],["Communication Platforms",i.COMMUNICATION_PLATFORMS,"communicationPlatforms",{...s.defaultStoreOptions,key:"communicationPlatforms",storeState:_().communicationPlatforms},r],["Community Checklists",i.COMMUNITY_CHECKLISTS,"communityChecklists",{...s.defaultStoreOptions,key:"communityChecklists",storeState:J().communityChecklists},r],["Faith Milestones",i.FAITH_MILESTONES,"faithMilestones",{...s.defaultStoreOptions,key:"faithMilestones",storeState:w().faithMilestones},r]],u=k({faithMilestoneStore:w(),settings:S(),peopleGroupStore:C(),languageStore:p(),communicationPlatformStore:_()}),O=async()=>{for(const[e,n,l,g,d]of o){if(s.currentTaskText=`Fetching ${e}...`,await P(e,n,d,{...s.defaultStoreOptions,key:l,store:g}),e==="Languages")try{const t=await a("languages",[]);let y;t&&t.length&&(y=t.find(T=>T.locale==="en"),u.settings.setUserPreferredLanguage(y))}catch(t){console.error("Error reading languages from secure storage",t)}if(e==="Statuses"){const t=await a("statuses",[]);u.settings.setStatuses(t)}if(e==="Faith Milestones"){const t=await a("faithMilestones",[]);u.faithMilestoneStore.setFaithMilestones(t)}if(e==="People Groups"){const t=await a("peopleGroups",[]);u.peopleGroupStore.setPeopleGroups(t)}if(e==="Language Words"){const t=await a("languageWords",[]);u.languageStore.setWords(t)}if(e==="Languages"){const t=await a("languages",[]);u.languageStore.setLanguages(t)}if(e==="Communication Platforms"){const t=await a("communicationPlatforms",[]);u.communicationPlatformStore.setCommunicationPlatforms(t)}await f(500),s.logoLoaded||(s.logoLoaded=!0)}R("/landing")},P=async(e,n,l,g)=>{await(await I(n)).browse(l,g),s.completedModules.push(e),e==="Community Checklists"&&(s.currentTaskText="Redirecting . . . ")};return O(),(e,n)=>{const l=L;return x(),G("div",q,[N(l,{vertical:""},{default:E(()=>[U(A(F(s).currentTaskText),1)]),_:1})])}}}),le=W(D,[["__scopeId","data-v-2d304dda"]]);export{le as default};
