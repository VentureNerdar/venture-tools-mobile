import{p as h,E as c,R as g,n as f}from"./Dmm6Q3hy.js";const m=h("auth",()=>{const a=g(),n=c(null),r=c(JSON.parse(localStorage.getItem("authUser")||"{}")),i=c(localStorage.getItem("Bearer")||"");async function s(){const o=localStorage.getItem("Bearer")||"",e={Accept:"application/json","Content-Type":"application/json"};o&&(e.Authorization=o);const t=await $fetch(a.public.apiURL+"auth/user",{method:"GET",credentials:"include",headers:e}).catch(p=>{console.log(p)});t&&(n.value=t,r.value=t,localStorage.setItem("authUser",JSON.stringify(t)))}async function l(o){await $fetch(a.public.rootURL+"sanctum/csrf-cookie",{method:"GET",credentials:"include"});const e=await $fetch(a.public.apiURL+"login",{method:"POST",body:o,credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json"}}).catch(t=>{console.log(t)});return e&&"token"in e&&(i.value="Bearer "+e.token,localStorage.setItem("Bearer",i.value),await s()),e}async function u(){const o=localStorage.getItem("Bearer")||"",e={Accept:"application/json","Content-Type":"application/json"};o&&(e.Authorization=o),await $fetch(a.public.apiURL+"auth/logout",{method:"POST",credentials:"include",headers:e}).catch(t=>{console.log(t)}),n.value=null,localStorage.removeItem("Bearer"),f("/")}return{user:n,login:l,fetchUser:s,logout:u,authUser:r}});export{m as u};
