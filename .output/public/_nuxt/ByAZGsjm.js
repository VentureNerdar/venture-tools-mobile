import{s as D}from"./BIrX7Mvq.js";import{s as A}from"./IW4h0HQO.js";import{s as H}from"./rOA6ctrY.js";import{s as j}from"./DBFB9YKp.js";import{s as V}from"./ZaMcrE34.js";import{s as z}from"./soJAr4A7.js";import{s as G}from"./BhXTN8q3.js";import{s as J}from"./CsqBi8P6.js";import{s as K}from"./D1earmUa.js";import{j as O,v as W,r as u,R as k,y as C,P as Q,I as X,w as l,x as Y,o as Z,b as a,U as r,a as _,t as ee,an as h,d as q,D as oe}from"./DX7L8mW0.js";import"./C399Fyjm.js";import"./Ctc7qOvh.js";/* empty css        *//* empty css        */import{s as x}from"./DvxMi5gK.js";import{u as re}from"./B5QHbL8n.js";import"./B_Wp1ia-.js";import"./DlD6u9LM.js";import"./DRbOzoBI.js";import"./BdX5d0ox.js";import"./BbEgM1do.js";import"./DkQH-hTN.js";import"./DQJyiHEB.js";import"./CYA1mnle.js";import"./C0yiKs0t.js";import"./DVrzjvSN.js";import"./CQxdcAm9.js";const ie={class:"phone-row"},Re=O({__name:"register",setup(te){const y=Y(),$=W(),U=re(),m=u(""),f=u([]),v=u("+977"),L=[{text:"Nepal +977",value:"+977"},{text:"USA +1",value:"+1"},{text:"UK +44",value:"+44"},{text:"Thailand +66",value:"+66"},{text:"Myanmar +95",value:"+95"},{text:"Australia +61",value:"+61"},{text:"Japan +81",value:"+81"}],M=({selectedOptions:i})=>{v.value=i[0].value,e.visibility.countryPicker=!1},d=u(""),w=u([]),p=k({languages:[],movements:[]}),e=k({visibility:{languagePicker:!1,movementPicker:!1,countryPicker:!1,showPassword:!1,showConfirmPassword:!1},confirmPassword:"",form:{name:"",email:"",password:"",password_confirmation:"",user_role_id:4,movement_id:null,phone_number:"",biography:"",is_active:!0,first_time_login:!0,preferred_language_id:null}}),R=C(()=>p.languages.map(i=>({text:i.name,value:i.id}))),N=C(()=>p.movements.map(i=>({text:i.name,value:i.id}))),E=async()=>{const i=await $fetch(y.public.apiURL+"registration/options");p.languages=i.languages??[],p.movements=i.movements??[]},s={handle:{click:{confirmLanguagePicker:({selectedOptions:i})=>{e.form.preferred_language_id=i[0].value,m.value=i[0].text,f.value=[i[0].value],e.visibility.languagePicker=!1},confirmMovementPicker:({selectedOptions:i})=>{e.form.movement_id=i[0].value?i[0].value:null,d.value=i[0].text,w.value=[i[0].value],e.visibility.movementPicker=!1},register:async()=>{e.form.phone_number=v.value+e.form.phone_number,console.log("Register Form",e.form),await $fetch(y.public.apiURL+"registration/register",{method:"POST",body:e.form})?(x({type:"success",message:"Registration successful"}),setTimeout(()=>{oe("/login")},300)):x({type:"danger",message:"Registration failed"})}},validate:{confirmPasswordMatch:i=>i!==e.form.password?"Password do not match":!0,confirmPasswordLength:i=>i.length<8?"Password must be at least 8 characters":!0,confirmEmailMatch:i=>i!==e.form.email?"Email do not match ":!0}}};return Q(async()=>{await E();const i=U.userPreferredLanguage;i&&(e.form.preferred_language_id=i.id,f.value=[i.id],m.value=i.name)}),(i,o)=>{const S=D,n=A,g=H,c=j,B=V,I=V,T=z,b=G,P=J,F=K;return Z(),X(P,{direction:"vertical",fill:""},{default:l(()=>[a(S,{title:"Venture Tools",border:!1}),a(F,{onSubmit:s.handle.click.register},{default:l(()=>[a(T,{inset:!0,title:"Welcome! Please continue to register"},{default:l(()=>[a(n,{modelValue:r(e).form.name,"onUpdate:modelValue":o[0]||(o[0]=t=>r(e).form.name=t),label:"Name",placeholder:"Name",required:"",rules:[{required:!0,message:"Name is required"}]},null,8,["modelValue"]),a(n,{modelValue:r(e).form.email,"onUpdate:modelValue":o[1]||(o[1]=t=>r(e).form.email=t),label:"Email",placeholder:"Email",required:"",rules:[{required:!0,message:"Email is required"},{pattern:/.+@.+\..+/,message:"Invalid email"}]},null,8,["modelValue"]),a(n,{modelValue:r(e).confirmPassword,"onUpdate:modelValue":o[2]||(o[2]=t=>r(e).confirmPassword=t),label:"Confirm Email",placeholder:"Confirm Email",required:"",rules:[{required:!0,message:"Email is required"},{pattern:/.+@.+\..+/,message:"Invalid email"},{validator:s.handle.validate.confirmEmailMatch}]},null,8,["modelValue","rules"]),a(n,{label:"Phone",required:""},{input:l(()=>[_("div",ie,[_("div",{class:"country-code",onClick:o[3]||(o[3]=t=>r(e).visibility.countryPicker=!0)},ee(r(v)),1),a(n,{modelValue:r(e).form.phone_number,"onUpdate:modelValue":o[4]||(o[4]=t=>r(e).form.phone_number=t),placeholder:"Phone Number",rules:[{required:!0,message:"Phone is required"}]},null,8,["modelValue"])])]),_:1}),a(c,{show:r(e).visibility.countryPicker,"onUpdate:show":o[6]||(o[6]=t=>r(e).visibility.countryPicker=t),round:"",position:"bottom"},{default:l(()=>[a(g,{columns:L,onConfirm:M,onCancel:o[5]||(o[5]=t=>r(e).visibility.countryPicker=!1)})]),_:1},8,["show"]),a(n,{modelValue:r(m),"onUpdate:modelValue":o[7]||(o[7]=t=>h(m)?m.value=t:null),label:"Language",placeholder:"Language","is-link":"",readonly:"",required:"",onClick:o[8]||(o[8]=t=>r(e).visibility.languagePicker=!0),rules:[{required:!0,message:"Language is required"}]},null,8,["modelValue"]),a(c,{show:r(e).visibility.languagePicker,"onUpdate:show":o[10]||(o[10]=t=>r(e).visibility.languagePicker=t),"destroy-on-close":"",round:"",position:"bottom"},{default:l(()=>[a(g,{"model-value":r(f),columns:r(R),onCancel:o[9]||(o[9]=t=>r(e).visibility.languagePicker=!1),onConfirm:s.handle.click.confirmLanguagePicker},null,8,["model-value","columns","onConfirm"])]),_:1},8,["show"]),a(n,{modelValue:r(d),"onUpdate:modelValue":o[11]||(o[11]=t=>h(d)?d.value=t:null),label:"Movement",placeholder:"Movement","is-link":"",readonly:"",onClick:o[12]||(o[12]=t=>r(e).visibility.movementPicker=!0),required:"",rules:[{required:!0,message:"Movement is required"}]},null,8,["modelValue"]),a(c,{show:r(e).visibility.movementPicker,"onUpdate:show":o[14]||(o[14]=t=>r(e).visibility.movementPicker=t),"destroy-on-close":"",round:"",position:"bottom"},{default:l(()=>[a(g,{"model-value":r(w),columns:r(N),onCancel:o[13]||(o[13]=t=>r(e).visibility.movementPicker=!1),onConfirm:s.handle.click.confirmMovementPicker},null,8,["model-value","columns","onConfirm"])]),_:1},8,["show"]),a(n,{modelValue:r(e).form.biography,"onUpdate:modelValue":o[15]||(o[15]=t=>r(e).form.biography=t),label:"Biography",placeholder:"Biography",type:"textarea",autosize:{minHeight:50,maxHeight:120}},null,8,["modelValue"]),a(n,{modelValue:r(e).form.password,"onUpdate:modelValue":o[17]||(o[17]=t=>r(e).form.password=t),label:"Password",placeholder:"Password",type:r(e).visibility.showPassword?"text":"password",required:"",rules:[{required:!0,message:"Password is required"},{validator:s.handle.validate.confirmPasswordLength}]},{"right-icon":l(()=>[a(B,{name:r(e).visibility.showPassword?"closed-eye":"eye-o",onClick:o[16]||(o[16]=t=>r(e).visibility.showPassword=!r(e).visibility.showPassword)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),a(n,{modelValue:r(e).form.password_confirmation,"onUpdate:modelValue":o[19]||(o[19]=t=>r(e).form.password_confirmation=t),label:"Confirm Password",placeholder:"Confirm password",type:r(e).visibility.showConfirmPassword?"text":"password",required:"",rules:[{required:!0,message:"Please confirm password"},{validator:s.handle.validate.confirmPasswordMatch}]},{"right-icon":l(()=>[a(I,{name:r(e).visibility.showConfirmPassword?"closed-eye":"eye-o",onClick:o[18]||(o[18]=t=>r(e).visibility.showConfirmPassword=!r(e).visibility.showConfirmPassword)},null,8,["name"])]),_:1},8,["modelValue","type","rules"])]),_:1}),a(P,{direction:"vertical",fill:"",style:{padding:"16px"}},{default:l(()=>[a(b,{type:"primary",block:"","native-type":"submit"},{default:l(()=>o[21]||(o[21]=[q(" Register ")])),_:1}),a(b,{type:"primary",plain:"",block:"",onClick:o[20]||(o[20]=t=>r($).push("/login"))},{default:l(()=>o[22]||(o[22]=[q("Cancel")])),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})}}});export{Re as default};
