import{A as p,ar as ae,q as y,am as B,x as b,a1 as se,a0 as U,J as le,a5 as z,b6 as ce,af as F,E as x,g as E,j as D,a6 as H,b as c,aS as M,b7 as G,a4 as re,aj as Y,ao as q,aw as V,ap as k,s as O,k as ie,B as ue,ad as de,F as fe,b8 as ve,a9 as me,av as ye,b9 as he,r as pe,aq as Ie,$ as we,aU as Oe}from"./Dmm6Q3hy.js";import{u as be}from"./Bwn9jZ5r.js";import{c as ke,P as Ce}from"./BuLzc7N1.js";import{u as R}from"./eq3yB9Uz.js";import{w as Z,H as ge,I as Se}from"./C4DoHFH8.js";function J(e){const o=ae();o&&p(o.proxy,e)}const _={show:Boolean,zIndex:b,overlay:y,duration:b,teleport:[String,Object],lockScroll:y,lazyRender:y,beforeClose:Function,overlayStyle:Object,overlayClass:B,transitionAppear:Boolean,closeOnClickOverlay:y},Xe=Object.keys(_);let w=0;const $="van-overflow-hidden";function Pe(e,o){const t=be(),l="01",n="10",r=u=>{t.move(u);const m=t.deltaY.value>0?n:l,A=ce(u.target,e.value),{scrollHeight:I,offsetHeight:g,scrollTop:S}=A;let d="11";S===0?d=g>=I?"00":"01":S+g>=I&&(d="10"),d!=="11"&&t.isVertical()&&!(parseInt(d,2)&parseInt(m,2))&&F(u,!0)},i=()=>{document.addEventListener("touchstart",t.start),document.addEventListener("touchmove",r,{passive:!1}),w||document.body.classList.add($),w++},s=()=>{w&&(document.removeEventListener("touchstart",t.start),document.removeEventListener("touchmove",r),w--,w||document.body.classList.remove($))},v=()=>o()&&i(),C=()=>o()&&s();se(v),U(C),le(C),z(o,u=>{u?i():s()})}function W(e){const o=x(!1);return z(e,t=>{t&&(o.value=t)},{immediate:!0}),t=>()=>o.value?t():null}const[xe,Ae]=D("overlay"),Te={show:Boolean,zIndex:b,duration:b,className:B,lockScroll:y,lazyRender:y,customStyle:Object,teleport:[String,Object]};var Be=E({name:xe,inheritAttrs:!1,props:Te,setup(e,{attrs:o,slots:t}){const l=x(),n=W(()=>e.show||!e.lazyRender),r=s=>{e.lockScroll&&F(s,!0)},i=n(()=>{var s;const v=p(re(e.zIndex),e.customStyle);return Y(e.duration)&&(v.animationDuration=`${e.duration}s`),q(c("div",k({ref:l,style:v,class:[Ae(),e.className]},o),[(s=t.default)==null?void 0:s.call(t)]),[[V,e.show]])});return H("touchmove",r,{target:l}),()=>{const s=c(M,{name:"van-fade",appear:!0},{default:i});return e.teleport?c(G,{to:e.teleport},{default:()=>[s]}):s}}});const ze=Z(Be),Ee=p({},_,{round:Boolean,position:O("center"),closeIcon:O("cross"),closeable:Boolean,transition:String,iconPrefix:String,closeOnPopstate:Boolean,closeIconPosition:O("top-right"),destroyOnClose:Boolean,safeAreaInsetTop:Boolean,safeAreaInsetBottom:Boolean}),[De,j]=D("popup");var _e=E({name:De,inheritAttrs:!1,props:Ee,emits:["open","close","opened","closed","keydown","update:show","clickOverlay","clickCloseIcon"],setup(e,{emit:o,attrs:t,slots:l}){let n,r;const i=x(),s=x(),v=W(()=>e.show||!e.lazyRender),C=ie(()=>{const a={zIndex:i.value};if(Y(e.duration)){const f=e.position==="center"?"animationDuration":"transitionDuration";a[f]=`${e.duration}s`}return a}),u=()=>{n||(n=!0,i.value=e.zIndex!==void 0?+e.zIndex:ve(),o("open"))},m=()=>{n&&ke(e.beforeClose,{done(){n=!1,o("close"),o("update:show",!1)}})},A=a=>{o("clickOverlay",a),e.closeOnClickOverlay&&m()},I=()=>{if(e.overlay)return c(ze,k({show:e.show,class:e.overlayClass,zIndex:i.value,duration:e.duration,customStyle:e.overlayStyle,role:e.closeOnClickOverlay?"button":void 0,tabindex:e.closeOnClickOverlay?0:void 0},R(),{onClick:A}),{default:l["overlay-content"]})},g=a=>{o("clickCloseIcon",a),m()},S=()=>{if(e.closeable)return c(Se,{role:"button",tabindex:0,name:e.closeIcon,class:[j("close-icon",e.closeIconPosition),ge],classPrefix:e.iconPrefix,onClick:g},null)};let d;const Q=()=>{d&&clearTimeout(d),d=setTimeout(()=>{o("opened")})},X=()=>o("closed"),ee=a=>o("keydown",a),oe=v(()=>{var a;const{destroyOnClose:f,round:T,position:P,safeAreaInsetTop:te,safeAreaInsetBottom:ne,show:N}=e;if(!(!N&&f))return q(c("div",k({ref:s,style:C.value,role:"dialog",tabindex:0,class:[j({round:T,[P]:P}),{"van-safe-area-top":te,"van-safe-area-bottom":ne}],onKeydown:ee},t,R()),[(a=l.default)==null?void 0:a.call(l),S()]),[[V,N]])}),L=()=>{const{position:a,transition:f,transitionAppear:T}=e,P=a==="center"?"van-fade":`van-popup-slide-${a}`;return c(M,{name:f||P,appear:T,onAfterEnter:Q,onAfterLeave:X},{default:oe})};return z(()=>e.show,a=>{a&&!n&&(u(),t.tabindex===0&&me(()=>{var f;(f=s.value)==null||f.focus()})),!a&&n&&(n=!1,o("close"))}),J({popupRef:s}),Pe(s,()=>e.show&&e.lockScroll),H("popstate",()=>{e.closeOnPopstate&&(m(),r=!1)}),ue(()=>{e.show&&u()}),de(()=>{r&&(o("update:show",!0),r=!1)}),U(()=>{e.show&&e.teleport&&(m(),r=!0)}),ye(Ce,()=>e.show),()=>e.teleport?c(G,{to:e.teleport},{default:()=>[I(),L()]}):c(fe,null,[I(),L()])}});const Le=Z(_e);function Ne(){const e=pe({show:!1}),o=n=>{e.show=n},t=n=>{p(e,n,{transitionAppear:!0}),o(!0)},l=()=>o(!1);return J({open:t,close:l,toggle:o}),{open:t,close:l,state:e,toggle:o}}function Re(e){const o=he(e),t=document.createElement("div");return document.body.appendChild(t),{instance:o.mount(t),unmount(){o.unmount(),document.body.removeChild(t)}}}const[$e,je]=D("notify"),Ke=["lockScroll","position","show","teleport","zIndex"],Ue=p({},_,{type:O("danger"),color:String,message:b,position:O("top"),className:B,background:String,lockScroll:Boolean});var Fe=E({name:$e,props:Ue,emits:["update:show"],setup(e,{emit:o,slots:t}){const l=n=>o("update:show",n);return()=>c(Le,k({class:[je([e.type]),e.className],style:{color:e.color,background:e.background},overlay:!1,duration:.2,"onUpdate:show":l},Ie(e,Ke)),{default:()=>[t.default?t.default():e.message]})}});let K,h;const He=e=>Oe(e)?e:{message:e};function Me(){({instance:h}=Re({setup(){const{state:e,toggle:o}=Ne();return()=>c(Fe,k(e,{"onUpdate:show":o}),null)}}))}const Ge=()=>({type:"danger",color:void 0,message:"",onClose:void 0,onClick:void 0,onOpened:void 0,duration:3e3,position:void 0,className:"",lockScroll:!1,background:void 0});let Ye=Ge();const qe=()=>{h&&h.toggle(!1)};function eo(e){if(we)return h||Me(),e=p({},Ye,He(e)),h.open(e),clearTimeout(K),e.duration>0&&(K=setTimeout(qe,e.duration)),h}export{Le as P,_ as a,_e as b,Ne as c,Re as m,Xe as p,eo as s,J as u};
