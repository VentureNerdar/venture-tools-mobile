import{s as k}from"./ur_VACmx.js";import{s as V}from"./MteXtcWH.js";import{s as F}from"./BnmBTv-t.js";import{s as R,a as U}from"./VRD8Ro5m.js";import{g as x,I as $,r as E,H as B,s as T,k as w,c as K,o as u,aA as v,l as o,F as I,b as r,v as _,w as s,d as m,t as A,m as G}from"./DSRRTXY0.js";import"./BcQqayPu.js";import"./CX4x1NNd.js";import{s as C}from"./DYh-pV2H.js";import{u as H}from"./X9qNQbWD.js";import"./CezKD8Jt.js";import"./DZMPMdYR.js";import"./BrLGy7Au.js";import"./DfeQPru4.js";import"./2_l4ffRN.js";import"./C7GL2vS7.js";import"./BgJQGM5x.js";import"./CX1sPtrm.js";import"./Cjyzoxt_.js";import"./Dbq6bm_i.js";import"./BfP4sV-O.js";const M=x({__name:"newPin",emits:["newPinChanged"],setup(S,{emit:c}){const p=c,P=H(),i=$(),e=E({form:{pin:"",confirmPin:"",currentPin:""},errorInfo:"",showPinForm:!1,show:{pinKeyboard:!1,confirmPinKeyboard:!1,currentPinKeyboard:!1,removePinKeyboard:!1},isChangingPin:!1,hasPin:!1});B(()=>{const t=localStorage.getItem("PINNumber");e.hasPin=!!t});const a={handle:{focus:{pin:()=>{e.show.pinKeyboard=!0,e.show.confirmPinKeyboard=!1,e.show.currentPinKeyboard=!1,e.show.removePinKeyboard=!1},confirmPin:()=>{e.show.confirmPinKeyboard=!0,e.show.pinKeyboard=!1,e.show.currentPinKeyboard=!1,e.show.removePinKeyboard=!1},currentPin:()=>{e.show.currentPinKeyboard=!0,e.show.pinKeyboard=!1,e.show.confirmPinKeyboard=!1,e.show.removePinKeyboard=!1},removePin:()=>{e.show.removePinKeyboard=!0,e.show.pinKeyboard=!1,e.show.confirmPinKeyboard=!1,e.show.currentPinKeyboard=!1}},showChangePinForm:()=>{e.showPinForm=!0,e.isChangingPin=!0},removePin:()=>{e.form.currentPin===localStorage.getItem("PINNumber")?(localStorage.removeItem("PINNumber"),C({type:"success",message:"PIN removed successfully",duration:2e3}),setTimeout(()=>{i.push("/settings/security")},300)):C({type:"danger",message:"Incorrect PIN",duration:2e3})}}},g=T(()=>{const t=e.form.pin.length===4&&e.form.confirmPin.length===4,n=e.form.pin===e.form.confirmPin;return e.isChangingPin?t&&n&&e.form.currentPin===localStorage.getItem("pin"):t&&n});w([()=>e.form.pin,()=>e.form.confirmPin],()=>{const t=e.form.pin.length===4&&e.form.confirmPin.length===4,n=e.form.pin===e.form.confirmPin;e.errorInfo=t&&!n?"PINs do not match":""}),w(()=>e.form.pin,t=>{t.length>4&&(e.form.pin=t.slice(0,4),console.log("new pin!",e.form.pin)),t.length===4&&p("newPinChanged",t)}),w(()=>e.form.confirmPin,t=>{t.length>4&&(e.form.confirmPin=t.slice(0,4))}),w(()=>e.form.currentPin,t=>{console.log(e.form.currentPin),t.length>4&&(e.form.currentPin=t.slice(0,4))});const N=()=>{g.value&&(localStorage.setItem("PINNumber",e.form.pin),C({type:"success",message:e.isChangingPin?"PIN changed successfully":"PIN created successfully",duration:2e3}),setTimeout(()=>{i.push("/settings/security")},300))};return(t,n)=>{const h=k,f=V,d=F,y=R,b=U;return u(),K("div",null,[o(e).hasPin&&!o(e).showPinForm?(u(),K(I,{key:0},[r(d,null,{default:s(()=>[r(f,null,{default:s(()=>[r(h,{block:"",type:"primary",onClick:a.handle.showChangePinForm},{default:s(()=>n[8]||(n[8]=[m(" Change PIN Number ")])),_:1},8,["onClick"])]),_:1}),r(f,null,{default:s(()=>[r(h,{block:"",type:"danger",onClick:a.handle.focus.removePin},{default:s(()=>n[9]||(n[9]=[m(" Remove PIN Number ")])),_:1},8,["onClick"])]),_:1})]),_:1}),o(e).show.removePinKeyboard?(u(),_(d,{key:0},{default:s(()=>[r(f,{title:"Enter PIN to remove"},{default:s(()=>[r(y,{value:o(e).form.currentPin,focused:o(e).show.removePinKeyboard,length:"4",onFocus:a.handle.focus.removePin},null,8,["value","focused","onFocus"]),r(b,{modelValue:o(e).form.currentPin,"onUpdate:modelValue":n[0]||(n[0]=l=>o(e).form.currentPin=l),show:o(e).show.removePinKeyboard,onBlur:n[1]||(n[1]=l=>o(e).show.removePinKeyboard=!1)},null,8,["modelValue","show"])]),_:1}),r(f,null,{default:s(()=>[r(h,{block:"",type:"danger",onClick:a.handle.removePin},{default:s(()=>n[10]||(n[10]=[m(" Confirm Remove ")])),_:1},8,["onClick"])]),_:1})]),_:1})):v("",!0)],64)):v("",!0),!o(e).hasPin||o(e).showPinForm?(u(),K(I,{key:1},[o(e).isChangingPin?(u(),_(d,{key:0,title:"Enter current PIN",style:{"padding-top":"10px","padding-bottom":"10px"}},{default:s(()=>[r(y,{value:o(e).form.currentPin,focused:o(e).show.currentPinKeyboard,length:"4",onFocus:a.handle.focus.currentPin},null,8,["value","focused","onFocus"]),r(b,{modelValue:o(e).form.currentPin,"onUpdate:modelValue":n[2]||(n[2]=l=>o(e).form.currentPin=l),show:o(e).show.currentPinKeyboard,onBlur:n[3]||(n[3]=l=>o(e).show.currentPinKeyboard=!1)},null,8,["modelValue","show"])]),_:1})):v("",!0),r(d,{title:o(P).translate("enter_your_pin_number"),style:{"padding-top":"10px","padding-bottom":"10px"}},{default:s(()=>[r(y,{value:o(e).form.pin,focused:o(e).show.pinKeyboard,length:"4",onFocus:a.handle.focus.pin},null,8,["value","focused","onFocus"]),r(b,{modelValue:o(e).form.pin,"onUpdate:modelValue":n[4]||(n[4]=l=>o(e).form.pin=l),show:o(e).show.pinKeyboard,onBlur:n[5]||(n[5]=l=>o(e).show.pinKeyboard=!1)},null,8,["modelValue","show"])]),_:1},8,["title"]),r(d,{title:o(P).translate("confirm_your_pin_number"),style:{"padding-top":"10px","padding-bottom":"10px"}},{default:s(()=>[r(y,{value:o(e).form.confirmPin,focused:o(e).show.confirmPinKeyboard,"error-info":o(e).errorInfo,length:"4",onFocus:a.handle.focus.confirmPin},null,8,["value","focused","error-info","onFocus"]),r(b,{modelValue:o(e).form.confirmPin,"onUpdate:modelValue":n[6]||(n[6]=l=>o(e).form.confirmPin=l),show:o(e).show.confirmPinKeyboard,onBlur:n[7]||(n[7]=l=>o(e).show.confirmPinKeyboard=!1)},null,8,["modelValue","show"])]),_:1},8,["title"]),r(f,null,{default:s(()=>[r(h,{block:"",type:"success",disabled:!o(g),onClick:N},{default:s(()=>[m(A(o(P).translate("save")),1)]),_:1},8,["disabled"])]),_:1})],64)):v("",!0)])}}}),ae=x({__name:"pin",setup(S){const c=$(),p=G(!1);return B(()=>{p.value=!!localStorage.getItem("PINNumber")}),(P,i)=>{const e=k,a=V,g=F,N=M;return u(),K("div",null,[o(p)?(u(),_(g,{key:0},{default:s(()=>[r(a,null,{default:s(()=>[r(e,{block:"",type:"primary",onClick:i[0]||(i[0]=t=>o(c).push("/settings/security/edit-pin"))},{default:s(()=>i[2]||(i[2]=[m(" Change PIN Number ")])),_:1})]),_:1}),r(a,null,{default:s(()=>[r(e,{block:"",type:"danger",onClick:i[1]||(i[1]=t=>o(c).push("/settings/security/delete-pin"))},{default:s(()=>i[3]||(i[3]=[m(" Remove PIN Number ")])),_:1})]),_:1})]),_:1})):(u(),_(N,{key:1}))])}}});export{ae as default};
