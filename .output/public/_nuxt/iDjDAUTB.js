import{s as L}from"./BoM0zLUi.js";import{g as M,r as h,A as G,D as k,c as N,b as v,w as E,p as R,o as I,d as A,t as F,G as U}from"./B11RYdGN.js";import{R as i,u as x}from"./nRERUYJs.js";import{u as g}from"./CoSyPuiO.js";import{u as S}from"./FYlJaNEP.js";import{u as C,a as O}from"./RYy6bQbM.js";import{u as _}from"./BLRJAXKs.js";import{S as m}from"./BWukgpWs.js";import{u as J}from"./BAMog5sZ.js";import{_ as V}from"./DlAUqK2U.js";import"./B5XPjFbi.js";import"./C3wcNxUf.js";import"./Cxgz1JlQ.js";import"./DGLArwE6.js";import"./Ckordjsn.js";import"./DRbOzoBI.js";import"./DVHA2PAB.js";import"./DbczqoSU.js";import"./BxqCbK8_.js";import"./DK5vlPBA.js";const W=M("communities",()=>{const c=h({}),a=h({});return{communities:c,communityChecklists:a,loadFromSecureStorage:async()=>{try{const s=await m.get({key:"communities"});c.value=JSON.parse(s.value)}catch(s){console.log(s),c.value={}}try{const s=await m.get({key:"communityChecklists"});a.value=JSON.parse(s.value)}catch(s){console.log(s),a.value={}}},setCommunities:async s=>{c.value=s,await m.set({key:"communities",value:JSON.stringify(s)})},setCommunityChecklists:async s=>{a.value=s,await m.set({key:"communityChecklists",value:JSON.stringify(s)})}}}),D={class:"wrap"},b=G({__name:"splash",setup(c){const a=async(e,n)=>{try{const{value:l}=await m.get({key:e});return JSON.parse(l)}catch{return n}},f=e=>new Promise(n=>setTimeout(n,e)),o=k({completedModules:[],currentTaskText:"",defaultStoreOptions:{isPersist:!0},stores:{languages:g(),settings:S()},logoLoaded:!1}),r={all:!0},s=[["User Roles",i.USERS_ROLES,"userRoles",{...o.defaultStoreOptions,key:"userRoles",storeState:J().userRoles},{...r,whereNotIn:{key:"id",value:[1,2]}}],["Languages",i.LANGUAGES,"languages",{...o.defaultStoreOptions,key:"languages",storeState:g().languages},{...r,with:JSON.stringify(["translations"])}],["Language Words",i.LANGUAGE_WORDS,"languageWords",{...o.defaultStoreOptions,key:"languageWords",storeState:g().words},r],["Statuses",i.SETTINGS_STATUSES,"statuses",{...o.defaultStoreOptions,key:"statuses",storeState:S().statuses},r],["People Groups",i.PEOPLE_GROUPS,"peopleGroups",{...o.defaultStoreOptions,key:"peopleGroups",storeState:C().peopleGroups},r],["Communication Platforms",i.COMMUNICATION_PLATFORMS,"communicationPlatforms",{...o.defaultStoreOptions,key:"communicationPlatforms",storeState:_().communicationPlatforms},r],["Community Checklists",i.COMMUNITY_CHECKLISTS,"communityChecklists",{...o.defaultStoreOptions,key:"communityChecklists",storeState:W().communityChecklists},r],["Faith Milestones",i.FAITH_MILESTONES,"faithMilestones",{...o.defaultStoreOptions,key:"faithMilestones",storeState:O().faithMilestones},r]],u=k({faithMilestoneStore:O(),settings:S(),peopleGroupStore:C(),languageStore:g(),communicationPlatformStore:_()}),w=async()=>{for(const[e,n,l,p,d]of s){if(o.currentTaskText=`Fetching ${e}...`,await P(e,n,d,{...o.defaultStoreOptions,key:l,store:p}),e==="Languages")try{const t=await a("languages",[]);let y;t&&t.length&&(y=t.find(T=>T.locale==="en"),u.languageStore.setUserPreferredLanguage(y))}catch(t){console.error("Error reading languages from secure storage",t)}if(e==="Statuses"){const t=await a("statuses",[]);u.settings.setStatuses(t)}if(e==="Faith Milestones"){const t=await a("faithMilestones",[]);u.faithMilestoneStore.setFaithMilestones(t)}if(e==="People Groups"){const t=await a("peopleGroups",[]);u.peopleGroupStore.setPeopleGroups(t)}if(e==="Languages"){const t=JSON.parse(localStorage.getItem("languages")||"[]");u.languageStore.setLanguages(t)}if(e==="Language Words"){const t=JSON.parse(localStorage.getItem("languageWords")||"[]");u.languageStore.setWords(t)}if(e==="Communication Platforms"){const t=await a("communicationPlatforms",[]);u.communicationPlatformStore.setCommunicationPlatforms(t)}await f(200),o.logoLoaded||(o.logoLoaded=!0)}R("/landing")},P=async(e,n,l,p)=>{await(await x(n)).browse(l,p),o.completedModules.push(e),e==="Faith Milestones"&&(o.currentTaskText="Redirecting . . . ")};return w(),(e,n)=>{const l=L;return I(),N("div",D,[v(l,{vertical:""},{default:E(()=>[A(F(U(o).currentTaskText),1)]),_:1})])}}}),le=V(b,[["__scopeId","data-v-345c0be9"]]);export{le as default};
