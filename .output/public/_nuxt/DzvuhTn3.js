import{s as x}from"./2AX6UfkK.js";import{j as R,g as B,s as $,q as N,b as o,aR as E,D as _,k as y,G as z,c as A,w as i,o as T,m as t,d as C,t as I,az as U}from"./u6fC7tWD.js";import{H as D,I as F}from"./CTlEqAmN.js";import{s as G}from"./B9pv9OEJ.js";import{s as H}from"./C6R8WYLe.js";import{b as j,s as q}from"./D7MUQNqq.js";import{s as K}from"./CeI-FrgY.js";import{s as M}from"./Dx_EUZAP.js";import"./Dm1rIfN4.js";/* empty css        */import{u as P}from"./CBAxZjcA.js";import{a as J,u as S}from"./CAaF2NtV.js";import{u as O,R as Q}from"./FkBlke4I.js";import"./K7NJ41b3.js";import"./GtHPCvl_.js";import"./B84h2mFo.js";import"./BwZJpxLn.js";import"./DFnIe-CS.js";import"./Cjt3Mm07.js";import"./C_9SK_o9.js";const[W,w]=R("tag"),X={size:String,mark:Boolean,show:N,type:$("default"),color:String,plain:Boolean,round:Boolean,textColor:String,closeable:Boolean};var Y=B({name:W,props:X,emits:["close"],setup(r,{slots:u,emit:f}){const m=p=>{p.stopPropagation(),f("close",p)},d=()=>r.plain?{color:r.textColor||r.color,borderColor:r.color}:{color:r.textColor,background:r.color},l=()=>{var p;const{type:v,mark:g,plain:a,round:e,size:s,closeable:V}=r,c={mark:g,plain:a,round:e};s&&(c[s]=s);const k=V&&o(F,{name:"cross",class:[w("close"),D],onClick:m},null);return o("span",{style:d(),class:w([c,v])},[(p=u.default)==null?void 0:p.call(u),k])};return()=>o(E,{name:r.closeable?"van-fade":void 0},{default:()=>[r.show?l():null]})}});const ke=B({__name:"profile",setup(r){const u=_(!1),f=_([]),m=_(""),d={roles:J().userRoles,auth:P()},l=_({id:null,name:"",username:"",email:"",phone_number:"",biography:"",preferred_language_id:"",user_role_id:null}),p=y(()=>S().languages.map(a=>({text:a.name,value:a.id})));z(()=>{if(d.auth.authUser&&(console.log("authStore",d.auth.authUser),l.value={...d.auth.authUser},l.value.preferred_language_id)){const a=S().languages.find(e=>e.id===l.value.preferred_language_id);a&&(f.value=[a.id],m.value=a.name)}});const v=y(()=>{var a;return(a=d.roles.find(e=>e.id===l.value.user_role_id))==null?void 0:a.label}),g={handle:{click:{logout:async()=>{await P().logout(),q({type:"success",message:"See you again!",duration:2e3})},confirmLanguage:({selectedOptions:a})=>{u.value=!1;const e=a[0];l.value.preferred_language_id=e.value,m.value=e.text,f.value=[e.value]},update:async()=>{const e=await O(Q.USERS,d.auth.authUser.id).save(l.value);console.log("Save",e)}}}};return(a,e)=>{const s=x,V=Y,c=G,k=H,L=j,b=K,h=M;return T(),A("div",null,[o(h,null,{default:i(()=>[o(s,{modelValue:t(l).name,"onUpdate:modelValue":e[0]||(e[0]=n=>t(l).name=n),label:"Name",placeholder:"Name"},null,8,["modelValue"]),o(c,{title:"User Role"},{value:i(()=>[o(V,{type:"primary"},{default:i(()=>[C(I(t(v)),1)]),_:1})]),_:1}),o(s,{modelValue:t(l).username,"onUpdate:modelValue":e[1]||(e[1]=n=>t(l).username=n),label:"Username",placeholder:"Username",readonly:""},null,8,["modelValue"]),o(s,{modelValue:t(l).email,"onUpdate:modelValue":e[2]||(e[2]=n=>t(l).email=n),label:"Email",placeholder:"Email"},null,8,["modelValue"]),o(s,{modelValue:t(l).phone_number,"onUpdate:modelValue":e[3]||(e[3]=n=>t(l).phone_number=n),label:"Phone",placeholder:"Phone"},null,8,["modelValue"]),o(s,{modelValue:t(l).biography,"onUpdate:modelValue":e[4]||(e[4]=n=>t(l).biography=n),label:"Biography",placeholder:"Biography"},null,8,["modelValue"]),o(s,{modelValue:t(m),"onUpdate:modelValue":e[5]||(e[5]=n=>U(m)?m.value=n:null),label:"Language",placeholder:"Preferred Language","is-link":"",readonly:"",onClick:e[6]||(e[6]=n=>u.value=!0)},null,8,["modelValue"]),o(L,{show:t(u),"onUpdate:show":e[8]||(e[8]=n=>U(u)?u.value=n:null),position:"bottom",round:""},{default:i(()=>[o(k,{"model-value":t(f),title:"Languages",columns:t(p),onCancel:e[7]||(e[7]=n=>u.value=!1),onConfirm:g.handle.click.confirmLanguage},null,8,["model-value","columns","onConfirm"])]),_:1},8,["show"]),o(c,null,{default:i(()=>[o(b,{onClick:g.handle.click.update,type:"primary",block:"",size:"small"},{default:i(()=>e[9]||(e[9]=[C("Update")])),_:1},8,["onClick"])]),_:1})]),_:1}),o(h,{title:"Authentication"},{default:i(()=>[o(c,{"is-link":"",title:"Change Password"}),o(c,{title:"Logout"},{value:i(()=>[o(b,{type:"danger",size:"mini",plain:"",block:"",onClick:g.handle.click.logout},{default:i(()=>e[10]||(e[10]=[C("Logout")])),_:1},8,["onClick"])]),_:1})]),_:1})])}}});export{ke as default};
